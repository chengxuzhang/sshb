/** layui插件化 By Violet_Ice紫冰 <violetice@aliyun.com> */
!function(t,e){"object"==typeof t.layui&&layui.define?layui.define(["jquery"],function(t){t("ddsort",e(layui.jquery))}):e(t.jQuery)}(this,function(n){var e={down:n.noop,move:n.noop,up:n.noop,target:"li",delay:100,cloneStyle:{"background-color":"#eee"},floatStyle:{position:"fixed","box-shadow":"10px 10px 20px 0 #eee",webkitTransform:"rotate(4deg)",mozTransform:"rotate(4deg)",msTransform:"rotate(4deg)",transform:"rotate(4deg)"}},B=function(t,e){if(e||(e=t.prev()),e.length){if(t.offset().left==e.offset().left)if(Math.abs(t.offset().top-(e.offset().top+e.outerHeight(!0)))<=5)return e;return B(t,e.prev())}},C=function(t,e,o){if(o||(o=t.next().not(e)),o.length){if(t.offset().left==o.offset().left)if(Math.abs(t.offset().top-(o.offset().top-t.outerHeight(!0)))<=5)return o;return C(t,e,o.next().not(e))}};return n.fn.ddsort=function(t){var r=n(document),A=n.extend(!0,{},e,t);return this.each(function(){var z=n(this),f="height",E="width";"border-box"==z.css("box-sizing")&&(f="outerHeight",E="outerWidth"),z.on("mousedown.DDSort touchstart.DDSort",A.target,function(t){var m=(new Date).getTime();if("mousedown"!=t.type||1==t.which){var e=t.target.tagName.toLowerCase();if("input"!=e&&"textarea"!=e&&"select"!=e&&"a"!=e&&"true"!=n(t.target).prop("contenteditable")){var y=this,D=n(y),b=D.offset(),S=t.pageX,w=t.pageY,o=t.originalEvent.targetTouches;"touchstart"==t.type&&o&&(S=o[0].pageX,w=o[0].pageY);var x=D.clone().css(A.cloneStyle).css("height",D[f]()).empty(),T=1,H=D.outerHeight(),W=D.outerWidth(),j=z.outerHeight(),L=z.outerWidth(),M=H,X=H,Y=W,k=W,q=3*H;return A.down.call(y),r.on("mousemove.DDSort touchmove.DDSort",function(t){var e=t.pageX,o=t.pageY,f=t.originalEvent.targetTouches;if("touchmove"==t.type&&f&&(e=f[0].pageX,o=f[0].pageY),!((new Date).getTime()-m<A.delay)){T&&(D.before(x).css("width",D[E]()).css(A.floatStyle).appendTo(D.parent()),T=0);var r=S-e,n=w-o,a=b.left-r,i=b.top-n;D.offset({left:a,top:i});var s=function(t){var e=t.prev();if(e.length&&t.offset().top==e.offset().top&&Math.abs(t.offset().left-(e.offset().left+e.outerWidth(!0)))<=5)return e}(x),l=function(t,e){var o=t.next().not(e);if(o.length&&t.offset().top==o.offset().top&&Math.abs(t.offset().left-(o.offset().left-t.outerWidth(!0)))<=5)return o}(x,D),u=B(x),c=C(x,D);u&&u.length&&i<u.offset().top+u.outerHeight(!0)/2?u.before(x):c&&c.length&&i+H>c.offset().top+c.outerHeight(!0)/2?c.after(x):s&&s.length&&a<s.offset().left+s.outerWidth(!0)/2?s.before(x):l&&l.length&&a+W>l.offset().left+l.outerWidth(!0)/2&&l.after(x);var h=z.scrollTop(),p=z.offset().top;if(i<p){X=H;var g=h-(M=++M>q?q:M);z.scrollTop(g)}else if(j<i+H-p){M=H;g=h+(X=++X>q?q:X);z.scrollTop(g)}var d=z.scrollLeft(),v=z.offset().left;if(a<z.offset().left){k=W;g=d-(Y=++Y>q?q:Y);z.scrollLeft(g)}else if(L<a+W-v){Y=W;g=d+(k=++k>q?q:k);z.scrollLeft(g)}A.move.call(y,a,i)}}).on("mouseup.DDSort touchend.DDSort",function(){r.off("mousemove.DDSort mouseup.DDSort touchmove.DDSort touchend.DDSort"),T||(x.before(D.removeAttr("style")).remove(),A.up.call(y))}),!1}}})})},{info:"layui插件化 By Violet_Ice紫冰 <violetice@aliyun.com>"}});